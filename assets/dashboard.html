<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Live Threat Intelligence Dashboard</title>
<style>
  body {
    background-color: #0f172a;
    color: #e5e7eb;
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    padding: 20px;
  }
  .dashboard {
    width: 320px;
  }
  .title { font-size: 16px; font-weight: bold; margin-bottom: 10px; }
  .metric { font-size: 18px; margin-bottom: 5px; }
  .critical { color: #ef4444; }
  .abnormal { color: #f97316; }
  .medium { color: #facc15; }
  .ok { color: #22c55e; }
  .small { font-size: 12px; color: #94a3b8; }
</style>
</head>
<body>
<div class="dashboard">
  <div class="title">Threat Intelligence Dashboard</div>
  <div class="metric critical" id="critical">Critical Alerts: 0</div>
  <div class="metric abnormal" id="abnormal">Abnormal Alerts: 0</div>
  <div class="metric medium" id="medium">Medium Severity: 0</div>
  <div class="metric ok" id="investigated">Investigated: 0</div>
  <div class="small" id="updated">Updated: -</div>
</div>

<script>
async function updateDashboard() {
  try {
    const response = await fetch('assets/dashboard_data.json?cb=' + new Date().getTime());
    const data = await response.json();

    document.getElementById('critical').textContent = "Critical Alerts: " + data.critical;
    document.getElementById('abnormal').textContent = "Abnormal Alerts: " + data.abnormal;
    document.getElementById('medium').textContent = "Medium Severity: " + data.medium;
    document.getElementById('investigated').textContent = "Investigated: " + data.investigated;
    document.getElementById('updated').textContent = "Updated: " + data.updated;

    // Optional: flash numbers briefly
    ['critical','abnormal','medium','investigated'].forEach(id => {
      const el = document.getElementById(id);
      el.style.transition = "color 0.5s";
      el.style.color = "#ffffff";
      setTimeout(() => { 
        if(id=='critical') el.style.color="#ef4444";
        if(id=='abnormal') el.style.color="#f97316";
        if(id=='medium') el.style.color="#facc15";
        if(id=='investigated') el.style.color="#22c55e";
      }, 500);
    });

  } catch (err) {
    console.error("Failed to fetch dashboard JSON:", err);
  }
}

// Update every 5 seconds
updateDashboard();
setInterval(updateDashboard, 5000);
</script>
</body>
</html>
